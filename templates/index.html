<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Trust Web IDE</title>
    <link rel="icon" type="image/png" href="/static/logo.png">
    <style>
        body { background: #0b0e14; color: #abb2bf; font-family: 'Fira Code', monospace; display: flex; flex-direction: column; align-items: center; padding: 50px; }
        .editor-container { width: 80%; max-width: 1000px; background: #1c2128; border-radius: 10px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        
        /* Layout do Editor com N√∫meros */
        .editor-wrapper { display: flex; background: #0d1117; border: 1px solid #30363d; border-radius: 5px; overflow: hidden; }
        #line-numbers { padding: 15px 10px; background: #161b22; color: #484f58; text-align: right; min-width: 35px; font-size: 16px; line-height: 1.5; user-select: none; border-right: 1px solid #30363d; }
        
        textarea { 
            width: 100%; height: 350px; background: transparent; color: #00ff00; 
            border: none; padding: 15px; font-size: 16px; outline: none; resize: none; 
            line-height: 1.5; font-family: inherit; overflow-y: auto;
        }

        .actions { display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap; }
        button, select { padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: 0.3s; color: white; font-family: inherit; }
        .btn-run { background: #ff4500; }
        .btn-run:hover { background: #e63e00; transform: translateY(-2px); }
        .btn-save { background: #28a745; }
        .btn-save:hover { background: #218838; transform: translateY(-2px); }
        .btn-clear { background: #4b5563; }
        .btn-clear:hover { background: #374151; }
        select { background: #30363d; border: 1px solid #ff4500; outline: none; }

        /* Terminal */
        .terminal { margin-top: 30px; width: 100%; background: #000; border-left: 4px solid #ff4500; padding: 20px; color: #00ff00; min-height: 100px; text-align: left; border-radius: 0 5px 5px 0; font-size: 14px; }
        .line { margin-bottom: 5px; }
        .terminal-header { color: #ff4500; font-weight: bold; margin-bottom: 10px; border-bottom: 1px solid #222; }

        /* docs */
        .docs-container { width: 80%; max-width: 1000px; margin-top: 50px; text-align: left; }
        .docs-container h2 { color: #ff4500; border-bottom: 2px solid #30363d; padding-bottom: 10px; }
        .docs-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
        .doc-item { background: #1c2128; padding: 15px; border-radius: 8px; }
        .doc-item code { color: #ff4500; font-size: 1.1em; }

        /* --- ANIMA√á√ïES DA LOGO E T√çTULO --- */
        @keyframes brilhoSuave {
            0% { filter: drop-shadow(0 0 5px #ff4500); }
            50% { filter: drop-shadow(0 0 20px #ff4500); }
            100% { filter: drop-shadow(0 0 5px #ff4500); }
        }

        .logo-pulsante { animation: brilhoSuave 4s ease-in-out infinite; }

        /* Anima√ß√£o do T√≠tulo Pulsante Laranja */
        h1 { 
            color: #ff4500; margin-bottom: 20px; text-shadow: 2px 2px #000;
            display: inline-block;
            filter: drop-shadow(0 0 5px #ff4500);
            animation: brilhoSuave 4s ease-in-out infinite; 
        }

        /* --- NOVA ANIMA√á√ÉO DE DIGITA√á√ÉO INFINITA --- */
        .typing-animation {
            overflow: hidden; 
            border-right: 2px solid #ff4500; 
            white-space: nowrap; 
            margin: 0 auto; 
            letter-spacing: 0.15em; 
            /* Adicionado 'infinite' para repetir e 'alternate' para apagar como backspace */
            animation: 
                typing 4s steps(18, end) infinite alternate, 
                blink-caret 0.75s step-end infinite; 
        }

        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }

        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: #ff4500 }
        }
    </style>
</head>
<body>
    <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 20px;">
        <img src="/static/logo.png" alt="Logo Trust" width="80" height="80" class="logo-pulsante">
        <h1 class="typing-animation">TRUST WEB COMPILER</h1>
    </div>
    
    <div class="editor-container">
        <form action="/executar" method="post" id="codeForm">
            <div class="editor-wrapper">
                <div id="line-numbers">1</div>
                <textarea name="codigo" id="codigoInput" placeholder="// Escreva seu c√≥digo Trust aqui..." 
                    oninput="updateLineNumbers()" onscroll="syncScroll()">{{ codigo_previo if codigo_previo else '' }}</textarea>
            </div>
            
            <div class="actions">
                <button type="submit" class="btn-run">‚ñ∂ EXECUTAR C√ìDIGO</button>
                <button type="button" class="btn-save" onclick="baixarCodigo()">üíæ SALVAR .trust</button>
                <button type="button" class="btn-clear" onclick="limparTudo()">üóëÔ∏è LIMPAR</button>
                
                <select id="menuExemplos" onchange="carregarExemplo()">
                    <option value="">üìö Ver Exemplos...</option>
                    <option value="funcao">üõ†Ô∏è Exemplo de Fun√ß√£o</option>
                    <option value="math">üßÆ C√°lculos Matem√°ticos</option>
                    <option value="sorteio">üé≤ Sorteio</option>
                </select>
            </div>
        </form>

        {% if resultado %}
        <div class="terminal" id="terminalOutput">
            <div class="terminal-header">SA√çDA DO MOTOR v3.4</div>
            {% for linha in resultado %}
                <div class="line">> {{ linha }}</div>
            {% endfor %}
        </div>
        {% endif %}
    </div>

    <div class="docs-container">
        <h2>üìñ Manual da Linguagem Trust v3.1</h2>
        <div class="docs-grid">
            <div class="doc-item">
                <code>func nome() { };</code>
                <p>Define um bloco de c√≥digo reutiliz√°vel.</p>
            </div>
            <div class="doc-item">
                <code>let x = 10 + 5</code>
                <p>Suporta opera√ß√µes matem√°ticas (+, -, *, /).</p>
            </div>
            <div class="doc-item">
                <code>random(min, max)</code>
                <p>Gera n√∫meros aleat√≥rios para sistemas de sorte.</p>
            </div>
        </div>
    </div>

<script>
    function updateLineNumbers() {
        const textarea = document.getElementById('codigoInput');
        const lineNumbers = document.getElementById('line-numbers');
        const lines = textarea.value.split('\n').length;
        lineNumbers.innerHTML = Array.from({length: lines}, (_, i) => i + 1).join('<br>');
    }

    function syncScroll() {
        const textarea = document.getElementById('codigoInput');
        const lineNumbers = document.getElementById('line-numbers');
        lineNumbers.scrollTop = textarea.scrollTop;
    }

    const exemplos = {
        funcao: 'func darBoasVindas() {\n    print("Ola, Programador Trust!")\n    print("O motor v3.4 esta pronto.")\n};\n\ndarBoasVindas()\nprint("Fim da execucao.")',
        math: 'let base = 50\nlet bonus = random(1, 20)\nlet total = base + bonus\nprint("Resultado do Calculo:")\nprint(total)',
        sorteio: 'let n = random(1, 100)\nprint("Numero:")\nprint(n)\nif (n > 50) { print("Alto!") };'
    };

    function carregarExemplo() {
        const selecao = document.getElementById('menuExemplos').value;
        if (selecao && exemplos[selecao]) {
            document.getElementById('codigoInput').value = exemplos[selecao];
            updateLineNumbers();
        }
    }

    function baixarCodigo() {
        const texto = document.getElementById('codigoInput').value;
        if(!texto) return alert("Escreva algum c√≥digo!");
        const blob = new Blob([texto], { type: 'text/plain' });
        const link = document.createElement('a');
        link.download = 'projeto.trust';
        link.href = window.URL.createObjectURL(blob);
        link.click();
    }

    function limparTudo() {
        document.getElementById('codigoInput').value = '';
        updateLineNumbers();
        const terminal = document.getElementById('terminalOutput');
        if(terminal) terminal.style.display = 'none';
        document.getElementById('menuExemplos').value = '';
    }

    window.onload = updateLineNumbers;
</script>
</body>
</html>
